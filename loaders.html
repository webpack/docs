<!DOCTYPE html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content=""><meta name=author content=""><link rel=icon type=image/png href=/assets/favicon.png><link rel=stylesheet href=css/doc.css><title>loaders</title><body><script src=js/doc.js charset=utf-8 async></script><div class=container><div class=row><div class="col-md-3 nav"><div class=logo><ul class=cube-inner><li class=front></li><li class=back></li><li class=right></li><li class=left></li><li class=top></li><li class=bottom></li></ul><ul class=cube><li class=front></li><li class=back></li><li class=right></li><li class=left></li><li class=top></li><li class=bottom></li><li class=floor></li></ul></div><div class=name>webpack</div><div class=tagline>MODULE BUNDLER</div><div class=sidebar><ul><li><a href=.>Home</a></li></ul><ul><li>Getting Started<ul><li><a href=motivation.html>Motivation</a></li><li><a href=what-is-webpack.html>What is webpack?</a></li><li><a href=installation.html>Installation</a></li><li><a href=usage.html>Usage</a></li><li>Require Modules</li><li>Vendor Modules</li><li><a href=using-loaders.html>Using Loaders</a></li><li><a href=using-plugins.html>Using Plugins</a></li><li><a href=dev-tools.html>Dev Tools</a></li></ul></li><li>tutorials and examples<ul><li><a href="http://webpack.github.io/docs/tutorials/getting-started/">Getting started</a></li><li><a href=list-of-tutorials.html>List of tutorials</a></li><li><a href=examples.html>examples</a></li></ul></li><li>Guides<ul><li><a href=commonjs.html>CommonJs</a></li><li><a href=amd.html>AMD</a></li><li><a href=webpack-for-browserify-users.html>webpack for browserify users</a></li><li><a href=code-splitting.html>Code Splitting</a></li><li><a href=stylesheets.html>Stylesheets</a></li><li><a href=optimization.html>Optimization</a></li><li><a href=long-term-caching.html>Long-term Caching</a></li><li><a href=how-to-write-a-loader.html>How to write a loader</a></li><li>How to write a plugin</li><li><a href=multiple-entry-points.html>Multiple entry points</a></li><li><a href=library-and-externals.html>Library and externals</a></li><li><a href=shimming-modules.html>Shimming modules</a></li><li><a href=testing.html>Testing</a></li><li><a href=build-performance.html>Build performance</a></li><li><a href=hot-module-replacement-with-webpack.html>Hot Module Replacement with webpack</a></li><li><a href=comparison.html>Comparison</a></li></ul></li><li>webpack with<ul><li><a href=usage-with-grunt.html>grunt</a></li><li><a href=usage-with-gulp.html>gulp</a></li><li><a href=usage-with-bower.html>bower</a></li><li><a href=usage-with-karma.html>karma</a></li></ul></li><li>Lists<ul><li><a href=loader-conventions.html>loader conventions</a></li><li><a href=list-of-loaders.html>List of loaders</a></li><li><a href=list-of-plugins.html>List of plugins</a></li><li><a href=list-of-tutorials.html>List of tutorials</a></li></ul></li><li>API<ul><li><a href=configuration.html>Configuration</a></li><li><a href=cli.html>CLI</a></li><li><a href=node.js-api.html>Node.js API</a></li><li><a href=api-in-modules.html>API in modules</a></li><li><a href=loaders.html>Loaders</a></li><li><a href=plugins.html>Plugins</a></li><li><a href=context.html>Context</a></li><li><a href=resolving.html>Resolving</a></li><li><a href=hot-module-replacement.html>Hot Module Replacement</a></li><li>Dev Tools<ul><li><a href=webpack-dev-server.html>webpack-dev-server</a></li><li><a href=webpack-dev-middleware.html>webpack-dev-middleware</a></li></ul></li></ul></li><li>Development<ul><li><a href=changelog.html>Changelog</a></li><li><a href=roadmap.html>Roadmap</a></li><li><a href=ideas.html>Ideas</a></li><li>Contributing</li></ul></li></ul></div></div><div class=col-md-9><div class=announcement><div class=announcement-inner><em>2014-07-04</em> Help to improve webpack by filling out <a href=https://docs.google.com/forms/d/101ZcujnVL8l575T6VRl62SfrVj5FZC1IzwMH1258GVc/viewform>this little survey</a>. Thanks!</div></div><div class=pull-right><a href=https://github.com/webpack/docs/wiki/loaders/_edit id=wikieditlink>Edit</a></div><div class=row><div class="col-md-12 page-header"><h1 id=wikititle>loaders</h1></div></div><div class=row><div id=wiki class=col-md-12><div class=contents><ul><li><a href=#introduction>Introduction</a><ul><li><a href=#parameters>parameters</a></li><li><a href=#loaders-by-config>loaders by config</a></li><li><a href=#loader-order>loader order</a></li><li><a href=#recommendations>recommendations</a></li></ul></li><li><a href=#writing-a-loader>Writing a loader</a><ul><li><a href=#examples>examples</a><ul><li><a href=#sync-loader>sync loader</a></li><li><a href=#async-loader>async loader</a></li><li><a href=#raw-loader>raw loader</a></li><li><a href=#pitching-loader>pitching loader</a></li></ul></li><li><a href=#loader-context>loader context</a><ul><li><a href=#version><code>version</code></a></li><li><a href=#context><code>context</code></a></li><li><a href=#request><code>request</code></a></li><li><a href=#query><code>query</code></a></li><li><a href=#data><code>data</code></a></li><li><a href=#cacheable><code>cacheable</code></a></li><li><a href=#loaders><code>loaders</code></a></li><li><a href=#loaderindex><code>loaderIndex</code></a></li><li><a href=#resource><code>resource</code></a></li><li><a href=#resourcepath><code>resourcePath</code></a></li><li><a href=#resourcequery><code>resourceQuery</code></a></li><li><a href=#emitwarning><code>emitWarning</code></a></li><li><a href=#emiterror><code>emitError</code></a></li><li><a href=#exec><code>exec</code></a></li><li><a href=#resolve><code>resolve</code></a></li><li><a href=#resolvesync><code>resolveSync</code></a></li><li><a href=#adddependency><code>addDependency</code></a></li><li><a href=#addcontextdependency><code>addContextDependency</code></a></li><li><a href=#cleardependencies><code>clearDependencies</code></a></li><li><a href=#values><code>values</code></a></li><li><a href=#inputvalues><code>inputValues</code></a></li><li><a href=#options><code>options</code></a></li><li><a href=#debug><code>debug</code></a></li><li><a href=#minimize><code>minimize</code></a></li><li><a href=#target><code>target</code></a></li><li><a href=#webpack><code>webpack</code></a></li><li><a href=#emitfile><code>emitFile</code></a></li><li><a href=#_compilation><code>_compilation</code></a></li><li><a href=#_compiler><code>_compiler</code></a></li></ul></li></ul></li></ul></div><h1 id=introduction><a class=anchor href=#introduction>&rarr;</a>Introduction</h1><p>Loaders are transformations that are applied on files. They preprocess files. I. e. they can transform coffeescript to javascript.</p><p>Loaders resolve similar to modules. You can apply loaders to modules by prefixing them in the <code>require</code> call:</p><pre><code><span class=keyword>var</span> moduleWithOneLoader = require(<span class=string>"loader!module"</span>);

<span class=comment>// Loader in current directory</span>
require(<span class=string>"./loader.js!module"</span>);

<span class=comment>// multiple loaders</span>
require(<span class=string>"loader1/main!./loader2!module"</span>);</code></pre><p>When using multiple loaders they are applied in a pipeline.</p><h2 id=parameters><a class=anchor href=#parameters>&rarr;</a>parameters</h2><p>Loaders accept query parameters:</p><pre><code>require(<span class=string>"loader?with=parameter!./file"</span>);</code></pre><p>The format of the query string is up to the loader, so check the loaders documentation to find out about the parameters the loader accept.</p><h2 id=loaders-by-config><a class=anchor href=#loaders-by-config>&rarr;</a>loaders by config</h2><p>In many cases the correct loader can be inferred from the filename. Therefore loaders can be specified in the configuration:</p><pre><code>{
    module: {
        loaders: [
            { test: <span class=regexp>/\.coffee$/</span>, loader: <span class=string>"coffee-loader"</span> }
        ],
        preLoaders: [
            { test: <span class=regexp>/\.coffee$/</span>, loader: <span class=string>"coffee-hint-loader"</span> }
        ]
    }
};</code></pre><p>If the loaders from the configuration is not suitable for a specific case it can be overwritten:</p><pre><code>require(<span class=string>"raw!./script.coffee"</span>); <span class=comment>// loaders, preLoaders and postLoaders are applied</span>
<span class=comment>// =&gt; coffee-loader ! raw ! coffee-hint-loader ! ./script.coffee</span>
require(<span class=string>"!raw!./script.coffee"</span>); <span class=comment>// only preLoaders and postLoaders are applied</span>
<span class=comment>// =&gt; raw ! coffee-hint-loader ! ./script.coffee</span>
require(<span class=string>"!!raw!./script.coffee"</span>); <span class=comment>// no loaders from configuration are applied</span>
<span class=comment>// =&gt; raw ! ./script.coffee</span>
<span class=comment>// The last case should only be used in generated code (generated by loaders)</span></code></pre><h2 id=loader-order><a class=anchor href=#loader-order>&rarr;</a>loader order</h2><ol><li>The file is read from filesystem</li><li><code>options.module.preLoaders</code> are applied</li><li><code>options.module.loaders</code> are applied</li><li>loaders from request are applied</li><li><code>options.module.postLoaders</code> are applied</li><li>done</li></ol><p>If request matches <code>/^!<span class=regexp>/</span></code> omit step 3.</p><p>If request matches <code>/^!!<span class=regexp>/</span></code> omit step 2., 3. and 5.</p><p>If request matches <code>/^-!<span class=regexp>/</span></code> omit step 2. and 3.</p><h2 id=recommendations><a class=anchor href=#recommendations>&rarr;</a>recommendations</h2><p>It is recommended that the result is <strong>javascript after step 3</strong>.</p><p>It is recommended to applied <strong>non-js to js transformations in step 2</strong> (or step 3 when they don’t apply globally).</p><p>It is recommended to <strong>stay in the same language in pre and post loaders</strong>.</p><p>Source code that want to override the non-js to js transformation should use the <code>!</code> prefix. (i. e. to transform it in another way)</p><p>The <code>!!</code> prefix and the <code>-!</code> prefix should only be used by loaders.</p><ul><li>Example for a preLoader: Image compression</li><li>Example for a loader (in config): coffee-script transformation</li><li>Example for a loader (in request): bundle loader</li><li>Example for a postLoader: Code coverage instrumenting</li></ul><h1 id=writing-a-loader><a class=anchor href=#writing-a-loader>&rarr;</a>Writing a loader</h1><p>Writing a loader is pretty simple. A loader is just a file that exports a function. The compiler calls this function and passes the result of the previous loader or the resource file into it. The <code><span class=keyword>this</span></code> context of the function is filled-in by the compiler with some useful methods that allow the loader to, among other things, change its invocation style to async or get query parameters. The first loader is passed one argument: the content of the resource file. The compiler expects a result from the last loader. The result should be a String or a Buffer (which is converted to a string), representing the javascript source code of the module. An optional SourceMap result (as JSON object) may also be passed.</p><p>A single result can be returned in sync mode. For multiple result the <code><span class=keyword>this</span>.callback</code> must be called. In async mode <code><span class=keyword>this</span>.async()</code> must be called. It returns <code><span class=keyword>this</span>.callback</code> if async mode is allowed. Then the loader must return <code><span class=literal>undefined</span></code> and call the callback.</p><p>Errors can be thrown in sync mode or the <code><span class=keyword>this</span>.callback</code> can be called with the error.</p><p><code>webpack</code> allows async mode in every case.</p><p><code>enhanced-require</code> allows async mode only with <code>require.ensure</code> or AMD <code>require</code>.</p><p>For more detailed instructions and guidelines, check out <a href=how-to-write-a-loader.html>How to write a loader</a>.</p><h2 id=examples><a class=anchor href=#examples>&rarr;</a>examples</h2><h3 id=sync-loader><a class=anchor href=#sync-loader>&rarr;</a>sync loader</h3><pre><code>module.exports = <span class=function><span class=keyword>function</span><span class=params>(content)</span> {</span>
  <span class=keyword>return</span> someSyncOperation(content);
};</code></pre><h3 id=async-loader><a class=anchor href=#async-loader>&rarr;</a>async loader</h3><pre><code>module.exports = <span class=function><span class=keyword>function</span><span class=params>(content)</span> {</span>
  <span class=keyword>var</span> callback = <span class=keyword>this</span>.async();
  <span class=keyword>if</span>(!callback) <span class=keyword>return</span> someSyncOperation(content);
  someAsyncOperation(content, <span class=function><span class=keyword>function</span><span class=params>(err, result)</span> {</span>
    <span class=keyword>if</span>(err) <span class=keyword>return</span> callback(err);
    callback(<span class=literal>null</span>, result);
  });
};</code></pre><blockquote><p>Note: It’s recommended to give an asnychron loader and fallback sync mode. This isn’t required for webpack, but allows to run the loader sync in enhanced-require.</p></blockquote><h3 id=raw-loader><a class=anchor href=#raw-loader>&rarr;</a>raw loader</h3><p>By default the resource file is threaded as <code>utf-<span class=number>8</span></code> string and passed as String to the loader. By setting <code>raw</code> to <code><span class=literal>true</span></code> the loader is passed the raw Buffer.</p><p>Every loader is allowed to deliver its result as String or as Buffer. The compiler converts them between loaders.</p><pre><code>module.exports = <span class=function><span class=keyword>function</span><span class=params>(content)</span> {</span>
  assert(content <span class=keyword>instanceof</span> Buffer);
  <span class=keyword>return</span> someSyncOperation(content);
  <span class=comment>// return value can be a Buffer too</span>
  <span class=comment>// This is also allowed if loader is not "raw"</span>
};
module.exports.raw = <span class=literal>true</span>;</code></pre><h3 id=pitching-loader><a class=anchor href=#pitching-loader>&rarr;</a>pitching loader</h3><p>The loaders are called from right to left. But in some cases loaders doesn’t care for the results of the previous loader or the resource. They only care for metadata. The <code>pitch</code> method on the loaders is called from left to right before the loaders are called. If a loader delivers a result in the pitch method the process turns around and skips the remaining loaders, continuing with the calls to the more left loaders. <code>data</code> can be passed between pitch and normal call.</p><pre><code>module.exports = <span class=function><span class=keyword>function</span><span class=params>(content)</span> {</span>
  <span class=keyword>return</span> someSyncOperation(content, <span class=keyword>this</span>.data.value);
};
module.exports.pitch = <span class=function><span class=keyword>function</span><span class=params>(remainingRequest, precedingRequest, data)</span> {</span>
  <span class=keyword>if</span>(someCondition()) {
    <span class=comment>// fast exit</span>
    <span class=keyword>return</span> <span class=string>"module.exports = require("</span> + JSON.stringify(<span class=string>"-!"</span> + remainingRequest) + <span class=string>");"</span>;
  }
  data.value = <span class=number>42</span>;
};</code></pre><h2 id=loader-context><a class=anchor href=#loader-context>&rarr;</a>loader context</h2><p>This stuff is available on <code><span class=keyword>this</span></code> in a loader.</p><p>For the example this require call is used:</p><p>In <code>/abc/file.js</code>:</p><pre><code>require(<span class=string>"./loader1?xyz!loader2!./resource?rrr"</span>);</code></pre><h3 id=version><a class=anchor href=#version>&rarr;</a><code>version</code></h3><p>Loader API version. Currently <code><span class=number>1</span></code>.</p><h3 id=context><a class=anchor href=#context>&rarr;</a><code>context</code></h3><p>A string. The directory of the module. Can be used as context for resolving other stuff.</p><p>In the example: <code>/abc</code> because <code>resource.js</code> is in this directory</p><h3 id=request><a class=anchor href=#request>&rarr;</a><code>request</code></h3><p>The resolved request string.</p><p>In the example: <code><span class=string>"/abc/loader1.js?xyz!/abc/node_modules/loader2/index.js!/abc/resource.js?rrr"</span></code></p><h3 id=query><a class=anchor href=#query>&rarr;</a><code>query</code></h3><p>A string. The query of the request for the current loader.</p><p>In the example: in loader1: <code><span class=string>"?xyz"</span></code>, in loader2: <code><span class=string>""</span></code></p><h3 id=data><a class=anchor href=#data>&rarr;</a><code>data</code></h3><p>A data object shared between the pitch and the normal phase.</p><h3 id=cacheable><a class=anchor href=#cacheable>&rarr;</a><code>cacheable</code></h3><pre><code>cacheable(flag = <span class=literal>true</span>: boolean)</code></pre><p>Make this loader result cacheable. By default it’s not cacheable.</p><p>A cacheable loader must have a deterministic result, when inputs and dependencies havn’t changed. This means the loader shoudn’t have other dependencies than specified with <code><span class=keyword>this</span>.addDependency</code>. Most loaders are deterministic and cacheable.</p><h3 id=loaders><a class=anchor href=#loaders>&rarr;</a><code>loaders</code></h3><pre><code>loaders = [{request: string, path: string, query: string, module: <span class=function><span class=keyword>function</span>}]</span></code></pre><p>An array of all the loaders. It is writeable in the pitch phase.</p><p>In the example:</p><pre><code>[
  { request: <span class=string>"/abc/loader1.js?xyz"</span>,
    path: <span class=string>"/abc/loader1.js"</span>,
    query: <span class=string>"?xyz"</span>,
    module: [Function]
  },
  { request: <span class=string>"/abc/node_modules/loader2/index.js"</span>,
    path: <span class=string>"/abc/node_modules/loader2/index.js"</span>,
    query: <span class=string>""</span>,
    module: [Function]
  }
]</code></pre><h3 id=loaderindex><a class=anchor href=#loaderindex>&rarr;</a><code>loaderIndex</code></h3><p>The index in the loaders array of the current loader.</p><p>In the example: in loader1: <code><span class=number>0</span></code>, in loader2: <code><span class=number>1</span></code></p><h3 id=resource><a class=anchor href=#resource>&rarr;</a><code>resource</code></h3><p>The resource part of the request, including query.</p><p>In the example: <code><span class=string>"/abc/resource.js?rrr"</span></code></p><h3 id=resourcepath><a class=anchor href=#resourcepath>&rarr;</a><code>resourcePath</code></h3><p>The resource file.</p><p>In the example: <code><span class=string>"/abc/resource.js"</span></code></p><h3 id=resourcequery><a class=anchor href=#resourcequery>&rarr;</a><code>resourceQuery</code></h3><p>The query of the resource.</p><p>In the example: <code><span class=string>"?rrr"</span></code></p><h3 id=emitwarning><a class=anchor href=#emitwarning>&rarr;</a><code>emitWarning</code></h3><pre><code>emitWarning(message: string)</code></pre><p>Emit a warning.</p><h3 id=emiterror><a class=anchor href=#emiterror>&rarr;</a><code>emitError</code></h3><pre><code>emitError(message: string)</code></pre><p>Emit an error.</p><h3 id=exec><a class=anchor href=#exec>&rarr;</a><code>exec</code></h3><pre><code>exec(code: string, filename: string)</code></pre><p>Execute some code fragment like a module.</p><blockquote><p>Hint: Don’t use <code>require(<span class=keyword>this</span>.resourcePath)</code>, use this function to make loaders chainable!</p></blockquote><h3 id=resolve><a class=anchor href=#resolve>&rarr;</a><code>resolve</code></h3><pre><code>resolve(context: string, request: string, callback: <span class=function><span class=keyword>function</span><span class=params>(err, result: string)</span>)</span></code></pre><p>Resolve a request like a require expression.</p><h3 id=resolvesync><a class=anchor href=#resolvesync>&rarr;</a><code>resolveSync</code></h3><pre><code>resolveSync(context: string, request: string) -&gt; string</code></pre><p>Resolve a request like a require expression.</p><h3 id=adddependency><a class=anchor href=#adddependency>&rarr;</a><code>addDependency</code></h3><pre><code>addDependency(file: string)
dependency(file: string) <span class=comment>// shortcut</span></code></pre><p>Add a file as dependency of the loader result.</p><h3 id=addcontextdependency><a class=anchor href=#addcontextdependency>&rarr;</a><code>addContextDependency</code></h3><pre><code>addContextDependency(directory: string)</code></pre><p>Add a directory as dependency of the loader result.</p><h3 id=cleardependencies><a class=anchor href=#cleardependencies>&rarr;</a><code>clearDependencies</code></h3><pre><code>clearDependencies()</code></pre><p>Remove all dependencies of the loader result. Even initial dependencies and these of other loaders. Consider using <code>pitch</code>.</p><h3 id=values><a class=anchor href=#values>&rarr;</a><code>values</code> (out)</h3><p>Pass values to the next loaders <code>inputValues</code>. If you know what your result exports if executed as module, set this value here (as a only element array).</p><h3 id=inputvalues><a class=anchor href=#inputvalues>&rarr;</a><code>inputValues</code></h3><p>Passed from the last loader. If you would execute the input argument as module, consider reading this variable for a shortcut (for performance).</p><h3 id=options><a class=anchor href=#options>&rarr;</a><code>options</code></h3><p>The options passed to the Compiler.</p><h3 id=debug><a class=anchor href=#debug>&rarr;</a><code>debug</code></h3><p>A boolean flag. It is set when in debug mode.</p><h3 id=minimize><a class=anchor href=#minimize>&rarr;</a><code>minimize</code></h3><p>Should the result be minimized.</p><h3 id=target><a class=anchor href=#target>&rarr;</a><code>target</code></h3><p>Target of compilation. Passed from configuration options.</p><p>Example values: <code><span class=string>"web"</span></code>, <code><span class=string>"node"</span></code></p><h3 id=webpack><a class=anchor href=#webpack>&rarr;</a><code>webpack</code></h3><p>Set to true when this is compiled by webpack.</p><h3 id=emitfile><a class=anchor href=#emitfile>&rarr;</a><code>emitFile</code></h3><pre><code>emitFile(name: string, content: Buffer|String, sourceMap: {...})</code></pre><p>Emit a file. This is webpack-specific</p><h3 id=_compilation><a class=anchor href=#_compilation>&rarr;</a><code>_compilation</code></h3><p>Hacky access to the Compilation object of webpack.</p><h3 id=_compiler><a class=anchor href=#_compiler>&rarr;</a><code>_compiler</code></h3><p>Hacky access to the Compiler object of webpack.</p></div></div></div></div></div><a href=https://github.com/webpack/webpack><img style="position: absolute; top: 0; left: 0; border: 0" src=https://s3.amazonaws.com/github/ribbons/forkme_left_orange_ff7600.png alt="Fork me on GitHub"></a>